name: check-routes
policies:
  - disallow-cluster-role-binding.yaml
resources:
  - resources.yaml
results:
  - policy: disallow-cluster-role-binding
    rule: check-cluster-role-binding-no-subject
    resource: self-provisioners
    kind: ClusterRoleBinding
    result: pass
  - policy: disallow-cluster-role-binding
    rule: check-cluster-role-binding-with-subject
    resource: self-provisioners-custom
    kind: ClusterRoleBinding
    result: fail
  - policy: disallow-cluster-role-binding
    rule: check-cluster-role-binding-with-subject
    resource: self-provisioners-custom-test
    kind: ClusterRoleBinding
    result: fail
  - policy: disallow-cluster-role-binding
    rule: check-cluster-role-binding-with-subject
    resource: system:openshift:scc:privileged
    kind: ClusterRoleBinding
    result: pass
